{"filter":false,"title":"Loot.js","tooltip":"/API/Rifts/Loot.js","undoManager":{"mark":1,"position":1,"stack":[[{"start":{"row":0,"column":0},"end":{"row":137,"column":3},"action":"remove","lines":["on(\"chat:message\", function (msg) {","    var tLOOT = '';","    var msgTxt = msg.content;","\tif(msg.type == \"api\" && msgTxt.indexOf(\"!loot\") !== -1) {","\t\tvar msgFormula = msgTxt.split(\" \");","\t\t//---------catch non players","\t\tvar cWho = findObjs({_type: 'character',name: msg.who})[0];","\t\tif(cWho === undefined) {","\t\t\tcWho = RollRight(msg.playerid);","\t\t\tmsg.who = cWho.get(\"name\");","\t\t}","\t\t//---------check credits set","\t\tvar oC = findObjs({name: \"Credits\",_type: \"attribute\",characterid: cWho.id}, {caseInsensitive: true})[0];","\t\tif(oC === undefined || oC.length === 0) {","\t\t\tsendChat(msg.who, '/direct No Credits Found, please set!');","\t\t\treturn;","\t\t}","\t\t/*------------------","        LOOT CALC","        ------------------*/","\t\telse {","\t\t\tvar aLoottext = fPart + \"background-color:##0B3B0B;'>● \" + msg.who + \" Looks for loot..  ●</div>\";","\t\t\tsendChat('', \"/direct \" + aLoottext);","\t\t\t//set times to run----------------------","\t\t\tvar x = 0;","\t\t\tvar times = msgFormula[1];","\t\t\tif(times > 20) {times = 20;}","\t\t\twhile(x < times || x < 1) {","\t\t\t\t//---------set cash or loot","\t\t\t\tvar loots = randomInteger(100);","\t\t\t\t//---------set cash or loot","\t\t\t\tlog(\"-KcVBLxjpNV8rVybDpD0\")","/*------------------","CASH LOOT","------------------*/","\t\t\t\tif(loots <= 25) {","\t\t\t\t\t//Set Cash Value---------------------------------","\t\t\t\t\tvar mColor = \"#456646\";","\t\t\t\t\tvar level = fLevel();","\t\t\t\t\tvar T = randomInteger(200)+randomInteger(50);","\t\t\t\t\t//---set big payout","\t\t\t\t\tvar BigMoney = randomInteger(100);","\t\t\t\t\tvar BigM = '';","\t\t\t\t\tif(BigMoney <= 10) {","\t\t\t\t\t\tvar BigM = (\"<a style='color:#00ff00'> BIG \");","\t\t\t\t\t\tT = (T * 20) + (150 * level);","\t\t\t\t\t\tmColor = \"#009605\";","\t\t\t\t\t}","\t\t\t\t\tvar cR = Math.floor(T * (level));","\t\t\t\t\t//give money-------------------------","\t\t\t\t\tvar credits = parseInt(oC.get(\"current\"));","\t\t\t\t\tvar credits = parseInt(credits);","\t\t\t\t\tvar total = credits + cR;","\t\t\t\t\toC.set('current', total);","\t\t\t\t\tvar gold = total.toString().replace(/\\B(?=(\\d{2})+(?!\\d))/g, \" \");","\t\t\t\t\t//tell money-------------------------","\t\t\t\t\tvar lootE = '<b><u>'+BigM+'MONEY:</a><br></b></u>' + cR + ' Credits. Your total: ' + total + ' </b>';","\t\t\t\t\tvar img = \"http:\\\\//i.imgur.com/PREQJkH.jpg\";","\t\t\t\t\ttLOOT = tLOOT + lPart + \"background-size:80px 60px; background-image: url(\"+img+\");'>\" + lootE +\"</div>\";","\t\t\t\t}","/*------------------","ITEM LOOT","------------------*/","\t\t\t\telse if(loots <= 85) {","\t\t\t\t\t//mundane loot-------------------------","\t\t\t\t\tvar items = findObjs({_type: \"tableitem\",_rollabletableid: \"-JCg8SKoOgAP2zgFnXk_\"});","\t\t\t\t\tvar rand1 = randomInteger(items.length);","\t\t\t\t\tvar chosen = items[rand1 - 1];","\t\t\t\t\tvar loot = chosen.get(\"name\");","\t\t\t\t\tvar loot1 = loot.split(\" \");","\t\t\t\t\tvar a = myrolls(loot1);","\t\t\t\t\tvar lootE = loot.replace(/\\[.*?\\]\\]/g, a);","\t\t\t\t\tvar img = \"http:\\\\//i.imgur.com/hc669Eb.jpg\";","\t\t\t\t\ttLOOT = tLOOT + lPart + \"background-size: 100%; background-image: url(\"+img+\");'><b><u> ITEM:</b></u> <a style='color:#888'>#\"+rand1+\" (\"+loots+\")</a><br>\"+lootE+\"</div>\";","\t\t\t\t}","\t\t\t\telse if(loots <= 95) {","\t\t\t\t\t//mundane loot-------------------------","\t\t\t\t\tvar items = findObjs({_type: \"tableitem\",_rollabletableid: \"-KcVBLxjpNV8rVybDpD0\"});","\t\t\t\t\tvar rand1 = randomInteger(items.length);","\t\t\t\t\tvar chosen = items[rand1 - 1];","\t\t\t\t\tvar loot = chosen.get(\"name\");","\t\t\t\t\tvar loot1 = loot.split(\" \");","\t\t\t\t\tvar a = myrolls(loot1);","\t\t\t\t\tvar lootE = loot.replace(/\\[.*?\\]\\]/g, a);","\t\t\t\t\tvar wQualList = ['Masterwork', 'Ornate', 'Fancy', 'Average', 'Poor', 'Cheap'];","                    var wQual = wQualList[Math.floor(Math.random() * wQualList.length)];","\t\t\t\t\tvar img = \"http:\\\\//i.imgur.com/hc669Eb.jpg\";","\t\t\t\t\ttLOOT = tLOOT + lPart + \"background-size: 100%; background-image: url(\"+img+\");'><b><u> ITEM:</b></u> <a style='color:#888'>#\"+rand1+\" (\"+loots+\")</a><br>\"+wQual+\" Quality \"+lootE+\"<b> (Appraise for value)</b></div>\";","\t\t\t\t}","/*------------------","WEAPON LOOT","------------------*/","\t\t\t\telse {","\t\t\t\t\tvar items = findObjs({_type: \"tableitem\",_rollabletableid: \"-JDlef2TgoMN63HS6hT1\"});","                    var rand1 = randomInteger(items.length);","\t\t\t\t\tvar chosen = items[rand1 - 1];","\t\t\t\t\tvar loot = chosen.get(\"name\");","\t\t\t\t\tvar loot1 = loot.split(\" \");","\t\t\t\t\tvar a = myrolls(loot1);","\t\t\t\t\tvar lootE = loot.replace(/\\[.*?\\]\\]/g, a);","                    var wQualList = ['Excellent', 'Good', 'Average', 'Poor', 'Salvageable', 'Broken'];","                    var wQual = wQualList[Math.floor(Math.random() * wQualList.length)];","\t\t\t\t\tvar img = \"http:\\\\//i.imgur.com/gGUKNRe.jpg\";","\t\t\t\t\ttLOOT = tLOOT + lPart + \"background-size: 100%; background-image: url(\"+img+\");'><b><u>WEAPON:</b></u> <a style='color:#888'>#\"+rand1+\" (\"+loots+\")</a><br>\"+wQual+\" \"+lootE+\"</div>\";","\t\t\t\t}","\t\t\t\tx++;","\t\t\t}","\t\t\tsendChat(msg.who, '/w gm ' + tLOOT);","\t\t\tsendChat(msg.who, \"/w \" + msg.who + ' ' + tLOOT);","\t\t};","\t}","});","on('chat:message', function (msg) {","    if(msg.type == 'api' && msg.content.indexOf('!Ches1t') !== -1) {","\t\tvar Names = [];","\t\tif(msg.selected == undefined) {","\t\t\tsendChat('', \"/desc No one selected\");","\t\t\treturn;","\t\t}","\t\tvar selected = msg.selected;","\t\ti = 0;","\t\t_.each(selected, function (obj) {","\t\t\tvar token = getObj('graphic', msg.selected[i]._id);","\t\t\tif(token.get(\"represents\") !== '') {","\t\t\t\tif(token.get('subtype') !== 'token') return;","\t\t\t\tvar oCharacter = getObj('character', token.get(\"_represents\"));","\t\t\t\tvar name = (oCharacter.get('name'));","\t\t\t\tNames.push(oCharacter);","\t\t\t}","\t\t\ti++;","\t\t});","\t\tvar rand = Names[Math.floor(Math.random() * Names.length)];","\t\tvar name = (rand.get('name'));","\t\tpColor = GetPColor(rand);","\t\tvar whoC = OuterDiv + iPart + \"background-color:#\"+pColor+\";'><b>● Who: \" + name + \"  ●</div>\";","\t\tsendChat('Picked', \"/direct \" +  whoC);","\t}","});"],"id":3},{"start":{"row":0,"column":0},"end":{"row":137,"column":3},"action":"insert","lines":["on(\"chat:message\", function (msg) {","    var tLOOT = '';","    var msgTxt = msg.content;","\tif(msg.type == \"api\" && msgTxt.indexOf(\"!loot\") !== -1) {","\t\tvar msgFormula = msgTxt.split(\" \");        ","\t\t//---------catch non players","\t\tvar cWho = findObjs({_type: 'character',name: msg.who})[0];","\t\tif(cWho === undefined) {            ","\t\t\tcWho = RollRight(msg.playerid);","\t\t\tmsg.who = cWho.get(\"name\");","\t\t}","\t\t//---------check credits set","\t\tvar oC = findObjs({name: \"Credits\",_type: \"attribute\",characterid: cWho.id}, {caseInsensitive: true})[0];","\t\tif(oC === undefined || oC.length === 0) {","\t\t\tsendChat(msg.who, '/direct No Credits Found, please set!');","\t\t\treturn;","\t\t}","\t\t/*------------------","        LOOT CALC","        ------------------*/","\t\telse {","\t\t\tvar aLoottext = fPart + \"background-color:##0B3B0B;'>● \" + msg.who + \" Looks for loot..  ●</div>\";","\t\t\tsendChat('', \"/direct \" + aLoottext);","\t\t\t//set times to run----------------------","\t\t\tvar x = 0;","\t\t\tvar times = msgFormula[1];","\t\t\tif(times > 20) {times = 20;}","\t\t\twhile(x < times || x < 1) {","\t\t\t\t//---------set cash or loot","\t\t\t\tvar loots = randomInteger(100);","\t\t\t\t//---------set cash or loot","\t\t\t\tlog(\"-KcVBLxjpNV8rVybDpD0\")","/*------------------","CASH LOOT","------------------*/","\t\t\t\tif(loots <= 25) {","\t\t\t\t\t//Set Cash Value---------------------------------","\t\t\t\t\tvar mColor = \"#456646\";","\t\t\t\t\tvar level = fLevel();","\t\t\t\t\tvar T = randomInteger(200)+randomInteger(50);","\t\t\t\t\t//---set big payout","\t\t\t\t\tvar BigMoney = randomInteger(100);","\t\t\t\t\tvar BigM = '';","\t\t\t\t\tif(BigMoney <= 10) {","\t\t\t\t\t\tvar BigM = (\"<a style='color:#00ff00'> BIG \");","\t\t\t\t\t\tT = (T * 20) + (150 * level);","\t\t\t\t\t\tmColor = \"#009605\";","\t\t\t\t\t}","\t\t\t\t\tvar cR = Math.floor(T * (level));","\t\t\t\t\t//give money-------------------------","\t\t\t\t\tvar credits = parseInt(oC.get(\"current\"));","\t\t\t\t\tvar credits = parseInt(credits);","\t\t\t\t\tvar total = credits + cR;","\t\t\t\t\toC.set('current', total);","\t\t\t\t\tvar gold = total.toString().replace(/\\B(?=(\\d{2})+(?!\\d))/g, \" \");","\t\t\t\t\t//tell money-------------------------","\t\t\t\t\tvar lootE = '<b><u>'+BigM+'MONEY:</a><br></b></u>' + cR + ' Credits. Your total: ' + total + ' </b>';","\t\t\t\t\tvar img = \"http:\\\\//i.imgur.com/PREQJkH.jpg\";","\t\t\t\t\ttLOOT = tLOOT + lPart + \"background-size:80px 60px; background-image: url(\"+img+\");'>\" + lootE +\"</div>\";","\t\t\t\t}","/*------------------","ITEM LOOT","------------------*/","\t\t\t\telse if(loots <= 85) {","\t\t\t\t\t//mundane loot-------------------------","\t\t\t\t\tvar items = findObjs({_type: \"tableitem\",_rollabletableid: \"-JCg8SKoOgAP2zgFnXk_\"});","\t\t\t\t\tvar rand1 = randomInteger(items.length);","\t\t\t\t\tvar chosen = items[rand1 - 1];","\t\t\t\t\tvar loot = chosen.get(\"name\");","\t\t\t\t\tvar loot1 = loot.split(\" \");","\t\t\t\t\tvar a = myrolls(loot1);","\t\t\t\t\tvar lootE = loot.replace(/\\[.*?\\]\\]/g, a);","\t\t\t\t\tvar img = \"http:\\\\//i.imgur.com/hc669Eb.jpg\";","\t\t\t\t\ttLOOT = tLOOT + lPart + \"background-size: 100%; background-image: url(\"+img+\");'><b><u> ITEM:</b></u> <a style='color:#888'>#\"+rand1+\" (\"+loots+\")</a><br>\"+lootE+\"</div>\";","\t\t\t\t}","\t\t\t\telse if(loots <= 95) {","\t\t\t\t\t//mundane loot-------------------------","\t\t\t\t\tvar items = findObjs({_type: \"tableitem\",_rollabletableid: \"-KcVBLxjpNV8rVybDpD0\"});","\t\t\t\t\tvar rand1 = randomInteger(items.length);","\t\t\t\t\tvar chosen = items[rand1 - 1];","\t\t\t\t\tvar loot = chosen.get(\"name\");","\t\t\t\t\tvar loot1 = loot.split(\" \");","\t\t\t\t\tvar a = myrolls(loot1);","\t\t\t\t\tvar lootE = loot.replace(/\\[.*?\\]\\]/g, a);","\t\t\t\t\tvar wQualList = ['Masterwork', 'Ornate', 'Fancy', 'Average', 'Poor', 'Cheap'];","                    var wQual = wQualList[Math.floor(Math.random() * wQualList.length)];","\t\t\t\t\tvar img = \"http:\\\\//i.imgur.com/hc669Eb.jpg\";","\t\t\t\t\ttLOOT = tLOOT + lPart + \"background-size: 100%; background-image: url(\"+img+\");'><b><u> ITEM:</b></u> <a style='color:#888'>#\"+rand1+\" (\"+loots+\")</a><br>\"+wQual+\" Quality \"+lootE+\"<b> (Appraise for value)</b></div>\";","\t\t\t\t}","/*------------------","WEAPON LOOT","------------------*/\t\t\t\t","\t\t\t\telse {","\t\t\t\t\tvar items = findObjs({_type: \"tableitem\",_rollabletableid: \"-JDlef2TgoMN63HS6hT1\"});","                    var rand1 = randomInteger(items.length);","\t\t\t\t\tvar chosen = items[rand1 - 1];","\t\t\t\t\tvar loot = chosen.get(\"name\");","\t\t\t\t\tvar loot1 = loot.split(\" \");","\t\t\t\t\tvar a = myrolls(loot1);","\t\t\t\t\tvar lootE = loot.replace(/\\[.*?\\]\\]/g, a);","                    var wQualList = ['Excellent', 'Good', 'Average', 'Poor', 'Salvageable', 'Broken'];","                    var wQual = wQualList[Math.floor(Math.random() * wQualList.length)];","\t\t\t\t\tvar img = \"http:\\\\//i.imgur.com/gGUKNRe.jpg\";","\t\t\t\t\ttLOOT = tLOOT + lPart + \"background-size: 100%; background-image: url(\"+img+\");'><b><u>WEAPON:</b></u> <a style='color:#888'>#\"+rand1+\" (\"+loots+\")</a><br>\"+wQual+\" \"+lootE+\"</div>\";","\t\t\t\t}","\t\t\t\tx++;","\t\t\t}","\t\t\tsendChat(msg.who, '/w gm ' + tLOOT);","\t\t\tsendChat(msg.who, \"/w \" + msg.who + ' ' + tLOOT);","\t\t};","\t}","});","on('chat:message', function (msg) {","    if(msg.type == 'api' && msg.content.indexOf('!Ches1t') !== -1) {","\t\tvar Names = [];","\t\tif(msg.selected == undefined) {","\t\t\tsendChat('', \"/desc No one selected\");","\t\t\treturn;            ","\t\t}","\t\tvar selected = msg.selected;","\t\ti = 0;","\t\t_.each(selected, function (obj) {","\t\t\tvar token = getObj('graphic', msg.selected[i]._id);","\t\t\tif(token.get(\"represents\") !== '') {","\t\t\t\tif(token.get('subtype') !== 'token') return;","\t\t\t\tvar oCharacter = getObj('character', token.get(\"_represents\"));","\t\t\t\tvar name = (oCharacter.get('name'));","\t\t\t\tNames.push(oCharacter);                ","\t\t\t}","\t\t\ti++;","\t\t});","\t\tvar rand = Names[Math.floor(Math.random() * Names.length)];","\t\tvar name = (rand.get('name'));","\t\tpColor = GetPColor(rand);","\t\tvar whoC = OuterDiv + iPart + \"background-color:#\"+pColor+\";'><b>● Who: \" + name + \"  ●</div>\";","\t\tsendChat('Picked', \"/direct \" +  whoC);","\t}","});"]}],[{"start":{"row":4,"column":37},"end":{"row":4,"column":45},"action":"remove","lines":["        "],"id":4},{"start":{"row":7,"column":26},"end":{"row":7,"column":38},"action":"remove","lines":["            "]},{"start":{"row":91,"column":20},"end":{"row":91,"column":24},"action":"remove","lines":["\t\t\t\t"]},{"start":{"row":117,"column":10},"end":{"row":117,"column":22},"action":"remove","lines":["            "]},{"start":{"row":127,"column":27},"end":{"row":127,"column":43},"action":"remove","lines":["                "]}]]},"ace":{"folds":[],"scrolltop":1139,"scrollleft":0,"selection":{"start":{"row":137,"column":3},"end":{"row":137,"column":3},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":80,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1489192073429,"hash":"6f46e36a635974638197274d7f32fa3f989b4d48"}